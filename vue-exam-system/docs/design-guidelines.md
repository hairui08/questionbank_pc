# 题库系统设计规范与技术约束

统一的设计系统、交互规范和技术标准，确保整个产品的一致性和高质量交付。

**📅 最后更新**: 2025-10-15
**✅ 强制执行**
**🔄 持续优化**

---

## 目录

- [UI规范](#ui规范)
- [组件库](#组件库)
- [交互规范](#交互规范)
- [技术规范](#技术规范)
- [测试要求](#测试要求)

---

## UI规范

统一的视觉设计系统，包含色彩、字体、间距等基础设计元素，确保产品视觉一致性。

### 色彩系统

使用 CSS 变量定义颜色，确保全局一致性。所有颜色值均经过无障碍对比度测试。

| 颜色名称 | CSS 变量 | 色值 | 用途 |
|---------|---------|------|------|
| Primary Blue | `--accent` | `#0066cc` | 主要操作按钮、链接 |
| Primary Blue Hover | `--accent-hover` | `#004f99` | 按钮悬停状态 |
| Primary Text | `--primary-text` | `#1a1a1a` | 主要文本颜色 |
| Secondary Text | `--secondary-text` | `#666666` | 辅助文本、说明文字 |
| Success Green | - | `#2e8b57` | 成功状态、启用标识 |
| Error Red | - | `#cf4a30` | 错误状态、禁用标识 |
| Background Gray | `--app-bg` | `#f5f5f5` | 页面背景色 |
| Panel White | `--panel-bg` | `#ffffff` | 面板、卡片背景色 |

### 字体系统

使用微软雅黑作为主字体，确保中文显示效果。所有字号遵循 8 的倍数原则。

| 级别 | 字号 | 字重 | 用途 |
|-----|------|------|------|
| H1 | 32px | 600 | 页面主标题 |
| H1 (常用) | 24px | 600 | 内容区标题 |
| H2 | 20px | 600 | 主要区块标题 |
| H3 | 18px | 600 | 次级标题 |
| H4 | 16px | 600 | 小标题 |
| 正文 | 14px | 400 | 正文内容 |
| 小字 | 12px | 400 | 辅助说明 |

### 间距系统

使用 8 的倍数作为基础间距单位，确保视觉节奏一致。

| 间距值 | 用途 |
|--------|------|
| 8px | 最小间距，用于紧密排列的元素 |
| 16px | 标准间距，用于常规元素 |
| 24px | 大间距，用于区块之间 |
| 32px | 超大间距，用于主要区块 |
| 48px | 特大间距，用于页面级别分隔 |

---

## 组件库

### 按钮组件

#### 主要按钮 (Primary Button)
- 背景：渐变蓝色 (`#4f77ff` → `#2f57e3`)
- 文字：白色
- 阴影：`0 4px 8px rgba(79, 119, 255, 0.3)`
- 悬停：渐变加深

```vue
<button class="btn primary">主要按钮</button>
```

#### 次要按钮 (Secondary Button)
- 背景：白色
- 文字：主题蓝 (`--accent`)
- 边框：`rgba(0, 102, 204, 0.4)`
- 悬停：淡蓝色背景 `rgba(0, 102, 204, 0.08)`

```vue
<button class="btn secondary">次要按钮</button>
```

#### 禁用按钮
- 透明度：`0.5`
- 鼠标样式：`not-allowed`
- 不响应交互

### 状态标签

#### 启用状态
- 背景：`#ecfff2`
- 文字：`#2e8b57`
- 边框：`rgba(46, 139, 87, 0.4)`

```vue
<span class="status is-active">启用</span>
```

#### 禁用状态
- 背景：`#fff3f0`
- 文字：`#cf4a30`
- 边框：`rgba(207, 74, 48, 0.3)`

```vue
<span class="status is-disabled">禁用</span>
```

### 标签组件

- 背景：`--badge-bg` (`#e6f2ff`)
- 文字：`--badge-text` (`#336699`)
- 圆角：`20px`
- 内边距：`4px 12px`

```vue
<span class="tag">v1.0</span>
```

### 表单组件

#### 文本输入框
```vue
<input type="text" placeholder="文本输入框">
```

#### 下拉选择
```vue
<select>
  <option>选项1</option>
  <option>选项2</option>
</select>
```

#### 复选框
```vue
<label>
  <input type="checkbox">
  <span>复选框</span>
</label>
```

---

## 交互规范

### 通用交互原则

#### 悬停反馈
- 所有可点击元素在悬停时必须有视觉反馈
- 过渡时间为 `0.2s`
- 使用 `ease` 缓动函数

#### 点击反馈
- 按钮点击时应有明显的状态变化
- 长时间操作需显示加载指示器

#### 焦点状态
- 表单元素获得焦点时显示蓝色边框 (`#0066cc`)
- 支持 Tab 键盘导航

#### 禁用状态
- 禁用元素透明度设为 `0.5`
- 鼠标指针显示为 `not-allowed`
- 不响应任何交互

#### 加载状态
- 异步操作时显示加载指示器
- 防止重复提交
- 操作完成后显示结果反馈

#### 错误提示
- 表单验证错误在失去焦点时实时显示
- 使用红色文字 (`#cf4a30`) 和红色边框

### 特定交互规范

#### 树形导航
- 点击项目头部展开/收起科目
- 点击科目加载对应内容
- 当前选中项高亮显示

#### 表格折叠
- 点击表格行展开/收起详情
- 支持多行同时展开
- 展开图标旋转 90 度动画

#### 弹窗操作
- 点击背景或按 ESC 键关闭弹窗
- 关键操作需二次确认
- 弹窗出现时焦点自动定位到首个输入框

#### 分页导航
- 支持页码点击、上下页按钮、页码跳转三种方式
- 当前页高亮
- 首末页禁用对应按钮

#### 状态切换
- 启用/禁用等关键操作需二次确认
- 确认对话框清晰说明操作影响

#### 删除保护
- 删除操作必须二次确认
- 存在关联数据时提示并拒绝删除
- 提供详细的影响说明

#### 试卷预览抽屉
- Drawer宽度: 80%(最大1200px)
- 从页面右侧滑入,滑入动画时长0.3秒
- 点击确定按钮或背景蒙层关闭
- 题目卡片带边框、圆角(12px)、轻微阴影(0 2px 8px rgba(0,0,0,0.05))
- 题型标签使用不同颜色区分:
  - 单选题: 蓝色(#e3f2fd / #1976d2)
  - 多选题: 紫色(#f3e5f5 / #7b1fa2)
  - 判断题: 绿色(#e8f5e9 / #388e3c)
  - 不定项: 橙色(#fff3e0 / #f57c00)
  - 简答题: 粉红(#fce4ec / #c2185b)
  - 组合题: 青色(#e0f2f1 / #00796b)
- 答案区域: 浅绿色背景(#e8f5e9)高亮,文字深绿色(#1b5e20)
- 解析区域: 浅蓝色背景(#e3f2fd)区分,文字深蓝色(#0d47a1)
- 选答题标识: 橙色标签(#fff3e0 / #f57c00)
- 内容区域支持滚动,平滑滚动体验

### Toast 提示规范

#### 成功提示
- 绿色渐变背景 (`#0f8a5f` → `#0c6f4c`)
- 白色文字
- 右下角显示
- 2.4 秒后自动消失

#### 错误提示
- 红色渐变背景 (`#d54a3c` → `#b13a30`)
- 白色文字
- 右下角显示
- 2.4 秒后自动消失

#### 提示内容
- 简洁明确，不超过 20 字
- 使用主动语态
- 避免技术术语
- 提供清晰的操作结果反馈

---

## 技术规范

统一的技术标准和约束，确保系统性能、安全性和可维护性。适用于所有模块的开发。

### 性能要求

- ✅ 页面首次加载时间 ≤ 2 秒
- ✅ 交互响应时间 ≤ 500ms
- ✅ 支持 100+ 项目/科目/章节同时展示
- ✅ 内存占用 ≤ 50MB
- ✅ 表格支持虚拟滚动，处理 1000+ 行数据
- ✅ 图片懒加载，减少初始加载时间

### 兼容性要求

- ✅ 支持 Chrome 90+
- ✅ 支持 Firefox 90+
- ✅ 支持 Safari 14+
- ✅ 支持 Edge 90+
- ✅ 支持 1366x768 以上分辨率
- ✅ 支持移动端访问（响应式设计）
- ✅ 支持键盘导航和无障碍访问（WCAG 2.1 AA 级）
- ❌ 不支持 IE 浏览器

### 安全要求

- ✅ 所有操作需要身份验证和权限校验
- ✅ 敏感操作（删除、禁用）需要二次确认
- ✅ 完整的操作日志记录（操作人、时间、内容）
- ✅ 数据传输使用 HTTPS
- ✅ 输入数据必须进行 XSS 防护
- ✅ 防止 CSRF 攻击
- ✅ 敏感信息不在前端存储

### 数据约束

| 字段 | 约束 |
|------|------|
| 项目名称 | 最多 50 字符，同一级别不能重复 |
| 科目名称 | 最多 50 字符，同一项目下不能重复 |
| 章节名称 | 最多 50 字符，同一科目下不能重复 |
| 小节名称 | 最多 50 字符，同一章节下不能重复 |
| 题型内部名称 | 系统预定义，不超过 20 字符 |
| 题型外部名称 | 最多 50 字符，同一科目下不能重复 |
| 题型描述 | 最多 200 字符 |
| 排序号范围 | 1-999，正整数，同级别不能重复 |
| 题干内容 | 1-5000 字符，同科目同章节唯一 |
| 选项内容 | 1-500 字符/选项 |
| 试题解析 | 1-3000 字符 |
| 案例背景 | 1-5000 字符（组合题） |

### 编码规范

- **Vue**: Composition API + `<script setup>` + TypeScript
- **HTML**: 2 空格缩进，标签和属性使用小写
- **CSS**: 使用 CSS 变量定义设计 tokens，scoped 样式
- **TypeScript**: 严格模式，驼峰命名
- **语义化**: HTML 标签，提升无障碍访问性
- **输入校验**: 所有用户输入必须校验和转义
- **注释**: 使用中文，技术术语保持英文原文

### 文件组织

```
src/
├── components/          # 通用组件
│   ├── Layout/         # 布局组件
│   ├── Tab/            # 标签页组件
│   ├── Modal/          # 弹窗组件
│   └── Feedback/       # 反馈组件
├── views/              # 页面视图
│   ├── project-management/
│   ├── chapter-management/
│   ├── question-type-management/
│   └── question-management/
├── stores/             # Pinia 状态管理
├── composables/        # 组合式函数
├── types/              # TypeScript 类型定义
└── router/             # 路由配置
```

---

## 测试要求

标准化的测试流程和验收标准，确保交付质量。所有模块必须严格执行以下测试要求。

### 功能测试

- ✅ 每次修改后必须手动测试核心功能流程
- ✅ 验证所有表单字段的校验逻辑（必填项、格式、长度）
- ✅ 测试所有交互元素的响应（按钮、链接、下拉菜单）
- ✅ 验证弹窗和 Toast 提示的正确显示
- ✅ 测试状态切换功能（启用/禁用、展开/收起）
- ✅ 验证数据的增删改查完整流程

### 边界测试

- ✅ 测试空数据状态下的页面展示和提示信息
- ✅ 测试最大数据量情况（100+ 记录、1000+ 字符）
- ✅ 验证字段长度限制的正确执行
- ✅ 测试重复数据的唯一性校验
- ✅ 验证排序值的边界情况（最小值 1、最大值 999）
- ✅ 测试网络延迟和错误情况的处理

### 兼容性测试

- ✅ 在 Chrome、Firefox、Safari 浏览器上测试核心功能
- ✅ 测试不同屏幕尺寸下的响应式布局（1366x768、1920x1080）
- ✅ 验证移动端访问的可用性
- ✅ 测试键盘导航（Tab 键、Enter 键、ESC 键）
- ✅ 使用屏幕阅读器验证无障碍访问

### 代码质量检查

- ✅ 浏览器控制台无 JavaScript 错误和警告
- ✅ 使用 ESLint 进行代码质量检查
- ✅ 验证所有链接和资源路径有效
- ✅ 检查 CSS 样式无冲突和覆盖问题
- ✅ 代码格式化符合项目规范（2 空格缩进）

### 验收标准模板

采用 **Given-When-Then** 格式编写验收标准:

**Given** (前置条件) → **When** (操作) → **Then** (预期结果)

#### 示例：新增功能验收

- **Given**: 用户在管理页面点击【新增】按钮
- **When**: 填写完整信息并提交
- **Then**: 系统验证通过，列表新增记录，显示成功提示

#### 示例：校验规则验收

- **Given**: 用户在新增弹窗中
- **When**: 输入已存在的名称并提交
- **Then**: 系统提示"该名称已存在"，拒绝提交

---

## 附录

### 组合题小问题型特殊说明

⚠️ **重要**: 组合题的小问**仅支持 4 种题型**:

- ✅ 单选题 (single)
- ✅ 多选题 (multiple)
- ✅ 判断题 (judgment)
- ✅ 简答题 (essay)
- ❌ **不支持不定项** (uncertain)

这是基于原型设计的有意限制，确保组合题的复杂度可控。

---

**文档版本**: v1.0
**维护者**: 题库系统开发团队
**反馈**: 如发现问题或建议，请提交 Issue
